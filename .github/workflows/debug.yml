name: debug build

on:
  push:
    branches:
      - cicd

jobs:
  building_debug:
    name: Builds & tests
    strategy:
      matrix:
        target: [
          {"tag":"debug", "dockerfile":"debug.dockerfile"},
          {"tag":"nigthly", "dockerfile":"Dockerfile"}
        ]
    uses: ./.github/workflows/full_build.yml
    with:
      DOCKER_BUILD_REPO: "nwodtuhs/exegol-builds"
      DOCKER_TARGET_REPO: "nwodtuhs/exegol-dev"
      IMAGE_BASE_NAME: ${{ fromJSON(matrix.target).tag }}
      DOCKERFILE: ${{ fromJSON(matrix.target).dockerfile }}
    secrets:
      DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
      DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
